{% extends 'base.html' %}

{% block title %}Catálogo{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-center">Catálogo de Productos</h1>
  <div class="row">
    {% for category in categories %}
      <h2>{{ category.name }}</h2>
      <div class="category-products d-flex flex-wrap gap-4">
        {% for product in category.product_set.all %}
          <div class="card product-card shadow-sm" style="width: 18rem;">
            <div class="card-img-wrapper">
              {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="card-img-top">
              {% else %}
                <img src="https://via.placeholder.com/200x200?text=Sin+Imagen" alt="Sin Imagen" class="card-img-top">
              {% endif %}
            </div>
            <div class="card-body d-flex flex-column">
              <h3 class="card-title h5">{{ product.name }}</h3>
              <p class="card-text flex-grow-1">{{ product.description|truncatechars:100 }}</p>
              <div class="card-footer bg-transparent border-0 mt-auto">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="price fw-bold fs-5">${{ product.price }}</div>
                  <div class="stock badge {% if product.is_in_stock %}bg-success{% else %}bg-danger{% endif %}">
                    {% if product.is_in_stock %}
                      En stock: {{ product.stock }}
                    {% else %}
                      Sin stock
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% empty %}
      <p>No hay productos disponibles en esta categoría.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}